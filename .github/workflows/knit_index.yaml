on:
  # Trigger the workflow on a successful merge
  # but only for the main branch
  push:
    branches:
      - main
    paths-ignore: # Don't trigger on files that are updated by the CI
      - '.gitignore'
      - 'README.md'
      - '.github/**'
 
jobs:
  run-rmarkdown:
    runs-on: windows-latest
    
    steps:
    - uses: actions/checkout@master
    - uses: r-lib/actions/setup-r@v1
      with:
        r-version: '4.1.2' # The R version to download (if necessary) and use.
    - uses: r-lib/actions/setup-pandoc@v1
    - name: Run gh_actions_run_script.R
      run: Rscript ./scripts/gh_actions_run_script.R
    - name: commit rendered README
      run: |
        git config --local user.name github-actions
        git config --local user.email "actions@github.com"
        git add index.html 
        git commit -m "Re-build index.html"
        git push origin main 
      env:
        REPO_KEY: ${{secrets.GITHUB_TOKEN}}
        username: github-actions
